<app-navbar></app-navbar>

<div class="gallery-view-container">

  <div *ngIf="loading" class="loading-container">
    <div class="loading-content">
      <div class="spinner"></div>
      <h2>Loading amazing project...</h2>
      <p>Preparing your 3D experience</p>
    </div>
  </div>
  <div *ngIf="error && !loading" class="error-container">
    <div class="error-content">
      <div class="error-icon">
        <i class="fas fa-exclamation-triangle"></i>
      </div>
      <h2>Oops! Something went wrong</h2>
      <p class="error-message">{{ error }}</p>
      <div class="error-actions">
        <button (click)="goBack()" class="btn btn-secondary">
          <i class="fas fa-arrow-left"></i>
          Back to Gallery
        </button>
        <button (click)="retry3DInitialization()" class="btn btn-primary">
          <i class="fas fa-refresh"></i>
          Try Again
        </button>
        <button (click)="forceInitialize3D()" class="btn btn-warning debug-btn">
          <i class="fas fa-cog"></i>
          Force Init 3D
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="!loading && !error && publicProject" class="project-view">
    
    <div class="project-header">
      <div class="title-section">
        <h1 class="project-title">{{ publicProject.title }}</h1>
        <div class="project-subtitle">
          <span class="author-info">
            <i class="fas fa-user-circle"></i>
            {{ publicProject.authorName }}
          </span>
          <span class="published-date">
            <i class="fas fa-calendar"></i>
            {{ formatDate(publicProject.publishedAt) }}
          </span>
        </div>
      </div>
      
      <div class="stats-actions">
        <div class="stats-row">
          <div class="stat-item">
            <i class="fas fa-eye"></i>
            <span>{{ formatNumber(publicProject.views) }}</span>
          </div>
          <div class="stat-item">
            <i class="fas fa-heart" [class.liked]="publicProject.isLikedByCurrentUser"></i>
            <span>{{ formatNumber(publicProject.likes) }}</span>
          </div>
        </div>
        
        <button 
          (click)="toggleLike()" 
          class="like-button"
          [class.liked]="publicProject.isLikedByCurrentUser"
          [disabled]="!currentUserId"
        >
          <i class="fas fa-heart"></i>
          <span>{{ publicProject.isLikedByCurrentUser ? 'Liked' : 'Like' }}</span>
        </button>
      </div>
  
    </div>
    <div class="view-3d-container">
      <div class="three-js-wrapper">
        <div #gallery3dContainer class="three-js-container"></div>
        
        <div *ngIf="!threeDInitialized && !error" class="three-d-loading">
          <div class="loading-animation">
            <div class="spinner-3d"></div>
          </div>
          <h3>Loading 3D Model...</h3>
        </div>
      </div>
      <div *ngIf="threeDInitialized" class="controls-info">
        <div class="controls-text">
          <i class="fas fa-mouse"></i>
          <span>Click & drag to rotate • Right-click to pan • Scroll to zoom</span>
        </div>
      </div>
    </div>
  </div>
</div>